<!doctype html>
<html lang="ko">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-+0n0xVW2eSR5OomGNYDnhzAbDsOXxcvSN1TPprVMTNDbiYZCxYbOOl7+AMvyTG2x" crossorigin="anonymous">
        <title>장소 상세보기</title>
        <style>


        </style>
    </head>
    <body>
      <nav class="navbar navbar-expand-lg navbar-light bg-light">
        <div class="container-fluid">
          <a class="navbar-brand" href="#">CleanVisit</a>

          <form class="d-flex">
            <input class="form-control me-2" type="search" placeholder="Search" aria-label="Search">
            <button type="button" class="btn btn-outline-primary" onclick="location.href='list.html'">Search</button>
          
          </form>

          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
          </button>
          <div class="collapse navbar-collapse" id="navbarSupportedContent">
            <ul class="navbar-nav me-auto mb-2 mb-lg-0">
              <li class="nav-item">
                <a class="nav-link" href="#" onclick="location.href='place_list_cafe.html'">카페</a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="#" onclick="location.href='place_list_restaurant.html'">음식점</a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="#" onclick="location.href='place_list_shopping.html'">쇼핑</a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="#" onclick="location.href='place_list_etc.html'">기타</a>
              </li>
            </ul>
            <button type="button" class="btn btn-outline-primary">로그인</button>
          </div>
        </div>
      </nav>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.1/dist/js/bootstrap.bundle.min.js" integrity="sha384-gtEjrD/SeCtmISkJkNUaaKMoLD0//ElJ19smozuHV6z3Iehds+3Ulb9Bn9Plx0x4" crossorigin="anonymous"></script>

        <br>
        <div id="place_info" style="height: auto; width: 98%; border:1px solid rgb(136, 136, 136); margin: 10px 10px 10px 10px; padding: 10px 10px 10px 10px;">
            <h3>[[${place.name}]]</h3>
            <img th:if="${place.imgUrl == null}" src="img/example_place.jpeg" id=place_img style="float: left; height: 180px; width: 240px; padding:8px;">
            <img  th:if="${place.imgUrl != null}" th:src="|/display?fileName=${place.imgUrl}|" id=place_img style="float: left; height: 180px; width: 240px; padding:8px;">
            <button th:if="${place.adminId != user.id}" class="btn btn-outline-primary" onclick="location.href='sanitary_update.html'" style="float: right;">방역정보 업데이트</button><br><br>
            <button class="btn btn-outline-primary" type="button" onclick="location.href='/reviews/register?place_seq=${place.seq}'" style="float: right;">리뷰 작성</button>
            <p><strong>주소: </strong> [[${place.address}]]</p>
            <p><strong>전화번호: </strong> [[${place.phone}]]</p>
            <br><br><br><br><br>
        </div>
        <br>
        <div id="review_simple" style= "height: 300px; width: 48%; float:left; border:1px solid rgb(136, 136, 136); margin: 10px 10px 10px 10px; padding: 10px 10px 10px 10px;">
            <h3>평가 및 리뷰</h3>
            <img th:src='|/img/star_@{place.reviewAvgScoreInt}.jpg|' style= 'float: left; height: 40px; width: 200px';>
            <br>
            <p>[[${place.reviewCount}]]건의 리뷰</p>
            <br><br><br><br>
            <a href="/reviews/list?type=PLACE&place_seq=[[${place.seq}]]" style="text-align: right;"> >>더보기</a>
        </div>
        <div id="place_detail" style= "height: 300px; width: 48%; float:right; border:1px solid rgb(136, 136, 136); margin: 10px 10px 10px 10px; padding: 10px 10px 10px 10px;">
            <h3>상세정보</h3>
            <strong>최근 방역 정보</strong>
<!--     2021년 5월 23일 AM 8:00       -->
            <p>[[${quarantine_date_string}]] 방역 완료</p>
            <br>
            <strong>위생관리 정보</strong>
            <p>입장 시 손 소독 여부: <span th:text="${place.hygieneManagement.handSanitization} ? 'O' : 'X'"></span><br>
            발열체크 여부: <span th:text="${place.hygieneManagement.heatCheck} ? 'O' : 'X'"></span><br>
            마스크 착용: <span th:text="${place.hygieneManagement.wearingMask} ? 'O' : 'X'"></span><br>
            거리두기 여부: <span th:text="${place.hygieneManagement.distance} ? 'O' : 'X'"></p>
        </div>
    </body>

    <script>
        $(document).ready(function() {
            $("#placeRegisterBtn").on("click", function () {

                        $.ajax({
                            url: '/places/'+place.seq+'/image',
                            processData: false,
                            contentType: false,
                            data: formData,
                            type: 'PUT',
                            dataType:'text',
                            success: function () {
                                location.href = '/places/detail?place_seq=' + place.seq;
                            },
                            error: function (jqXHR, textStatus, errorThrown) {
                                alert("code:"+jqXHR.status+"\n"
                                    +"message:"+jqXHR.responseText+"\n"
                                    +"error:"+errorThrown
                                );
                            }
                        });
                    },
            }
        });
    </script>
</html>
